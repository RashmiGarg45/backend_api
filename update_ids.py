import requests
import json
import os
import time
import random
from datetime import datetime
import mysql.connector as mysql

output_data = ['18742002', '18742005', '18742008', '18742011', '18742015', '18742027', '18742034', '18742035', '18742038', '18742040', '18742042', '18742043', '18742052', '18742055', '18742059', '18742066', '18742073', '18742075', '18742077', '18742078', '18742082', '18742085', '18742086', '18742094', '18742095', '18742099', '18742102', '18742105', '18742112', '18742115', '18742116', '18742118', '18742120', '18742121', '18742122', '18742125', '18742132', '18742135', '18742137', '18742140', '18742142', '18742146', '18742150', '18742157', '18742162', '18742163', '18742167', '18742171', '18742174', '18742178', '18742180', '18742184', '18742185', '18742186', '18742187', '18742192', '18742192', '18742194', '18742197', '18742208', '18742214', '18742218', '18742219', '18742220', '18742221', '18742222', '18742227', '18742228', '18742233', '18742233', '18742237', '18742238', '18742240', '18742241', '18742243', '18742244', '18742249', '18742257', '18742273', '18742275', '18742276', '18742277', '18742278', '18742279', '18742282', '18742284', '18742285', '18742286', '18742287', '18742292', '18742294', '18742297', '18742301', '18742304', '18742307', '18742308', '18742310', '18742313', '18742315', '18742318', '18742319', '18742321', '18742323', '18742325', '18742326', '18742327', '18742332', '18742339', '18742341', '18742344', '18742345', '18742347', '18742359', '18742360', '18742364', '18742366', '18742370', '18742373', '18742378', '18742397', '18742401', '18742407', '18742408', '18742409', '18742415', '18742424', '18742426', '18742428', '18742430', '18742431', '18742440', '18742442', '18742444', '18742445', '18742448', '18742451', '18742453', '18742454', '18742464', '18742470', '18742472', '18742475', '18742477', '18742478', '18742480', '18742488', '18742492', '18742494', '18742498', '18742499', '18742500', '18742503', '18742506', '18742507', '18742515', '18742516', '18742518', '18742519', '18742520', '18742521', '18742522', '18742524', '18742527', '18742532', '18742533', '18742534', '18742535', '18742537', '18742546', '18742551', '18742556', '18742561', '18742562', '18742566', '18742568', '18742569', '18742570', '18742571', '18742573', '18742574', '18742577', '18742582', '18742594', '18742597', '18742599', '18742607', '18742608', '18742609', '18742610', '18742612', '18742621', '18742626', '18742627', '18742632', '18742637', '18742640', '18742643', '18742645', '18742646', '18742648', '18742652', '18742653', '18742662', '18742663', '18742668', '18742670', '18742672', '18742674', '18742674', '18742677', '18742682', '18742683', '18742688', '18742690', '18742693', '18742694', '18742697', '18742702', '18742704', '18742705', '18742706', '18742707', '18742711', '18742714', '18742715', '18742718', '18742718', '18742721', '18742723', '18742726', '18742727', '18742730', '18742736', '18742741', '18742744', '18742745', '18742750', '18742751', '18742754', '18742756', '18742757', '18742763', '18742764', '18742774', '18742779', '18742780', '18742787', '18742788', '18742790', '18742791', '18742796', '18742799', '18742801', '18742804', '18742805', '18742811', '18742812', '18742818', '18742819', '18742825', '18742826', '18742828', '18742831', '18742841', '18742845', '18742846', '18742847', '18742848', '18742851', '18742857', '18742858', '18742858', '18742866', '18742867', '18742870', '18742874', '18742875', '18742877', '18742878', '18742880', '18742886', '18742888', '18742898', '18742901', '18742903', '18742914', '18742915', '18742918', '18742924', '18742925', '18742929', '18742931', '18742932', '18742933', '18742934', '18742940', '18742941', '18742942', '18742946', '18742954', '18742956', '18742961', '18742962', '18742963', '18742966', '18742967', '18742970', '18742972', '18742977', '18742986', '18742988', '18742990', '18742992', '18742995', '18742998', '18763000', '18763001', '18763003', '18763008', '18763012', '18763019', '18763025', '18763026', '18763028', '18763033', '18763034', '18763040', '18763041', '18763043', '18763052', '18763055', '18763059', '18763063', '18763065', '18763068', '18763072', '18763074', '18763076', '18763080', '18763084', '18763091', '18763094', '18763097', '18763107', '18763110', '18763114', '18763116', '18763117']

conn = mysql.connect(host="rds-datapis.cd89nha3un9e.us-west-2.rds.amazonaws.com", user="team2backend", passwd="123admin!", database="techteam")
cursor = conn.cursor()


cursor.execute('''SELECT DISTINCT user_id FROM myteam11_userId''')
sql_data = cursor.fetchall()

already_present_user_ids = []
for row in sql_data:
    already_present_user_ids.append(str(row[0]))


li = []

for user_id in output_data:
    if str(user_id) not in already_present_user_ids:
        created_at = datetime.fromtimestamp(time.time()).strftime("%d-%m-%Y %H:%M:%S:%f")[:-3]
        cursor.execute('''INSERT INTO myteam11_userId (user_id, isUsed, created_at )
                              VALUES ('{}', 0, '{}')'''.format(user_id ,created_at ))
        conn.commit()
        li.append(str(user_id))

print (len(li))


output_data = ['82787813', '82787807', '82787806']

conn = mysql.connect(host="rds-datapis.cd89nha3un9e.us-west-2.rds.amazonaws.com", user="team2backend", passwd="123admin!", database="techteam")
cursor = conn.cursor()


cursor.execute('''SELECT DISTINCT order_id FROM lenskart_orderId''')
sql_data = cursor.fetchall()

already_present_user_ids = []
for row in sql_data:
    already_present_user_ids.append(str(row[0]))


li = []

for user_id in output_data:
    if str(user_id) not in already_present_user_ids:
        created_at = datetime.fromtimestamp(time.time()).strftime("%d-%m-%Y %H:%M:%S:%f")[:-3]
        cursor.execute('''INSERT INTO lenskart_orderId (order_id, isUsed, created_at )
                              VALUES ('{}', 0, '{}')'''.format(user_id ,created_at ))
        conn.commit()
        li.append(str(user_id))

print (len(li))


output_data = [{'order_id': '000699701', 'order_date': u'2024-07-09T09:52:57.819112Z', 'waybill_no': '288012144'}, {'order_id': '000699567', 'order_date': u'2024-07-09T11:17:28.449562Z', 'waybill_no': '288012167'}, {'order_id': '000699691', 'order_date': u'2024-07-09T11:45:56.354898Z', 'waybill_no': '288012185'}, {'order_id': '000699703', 'order_date': u'2024-07-09T12:22:23.719273Z', 'waybill_no': '288012200'}, {'order_id': '000699765', 'order_date': u'2024-07-09T20:12:27.441977Z', 'waybill_no': '288012248'}, {'order_id': '000699731', 'order_date': u'2024-07-09T20:35:36.820538Z', 'waybill_no': '288012265'}, {'order_id': '000699815', 'order_date': u'2024-07-09T20:41:38.245609Z', 'waybill_no': '288012272'}, {'order_id': '000699829', 'order_date': u'2024-07-09T20:42:04.194494Z', 'waybill_no': '288012273'}, {'order_id': '000699835', 'order_date': u'2024-07-09T23:09:21.359374Z', 'waybill_no': '288012310'}, {'order_id': '000699875', 'order_date': u'2024-07-09T23:33:27.211622Z', 'waybill_no': '288012329'}, {'order_id': '000699893', 'order_date': u'2024-07-09T23:52:14.581867Z', 'waybill_no': '288012346'}]

conn = mysql.connect(host="rds-datapis.cd89nha3un9e.us-west-2.rds.amazonaws.com", user="team2backend", passwd="123admin!", database="techteam")
cursor = conn.cursor()
cursor.execute('''SELECT DISTINCT order_id FROM stylishop_orderId''')
sql_data = cursor.fetchall()

already_present_user_ids = []
for row in sql_data:
    already_present_user_ids.append(str(row[0]))

li = []

for data in output:
    order_id = data.get("order_id")
    order_date = data.get("order_date")
    payment_type = data.get("order_status")

    if str(order_id) not in already_present_user_ids:
        created_at = datetime.fromtimestamp(time.time()).strftime("%d-%m-%Y %H:%M:%S:%f")[:-3]
        cursor.execute('''INSERT INTO stylishop_orderId (order_id, order_date, payment_type, created_at, isUsed)
                              VALUES ('{}','{}','{}','{}', 0)'''.format(order_id, order_date,payment_type ,created_at ))
        conn.commit()
        li.append(str(order_id))

    pass

print (len(li))
